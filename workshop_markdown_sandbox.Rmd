---
title: "SEISMIC Collaborative LAK Workshop"
author: "V.Farrar"
date: "`r Sys.Date()`"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
syndat <- read.csv(file = "SEISMIC_synthetic_data_2023-01-26.csv")

#load packages
library(tidyverse)
```

# Define Your Course of Interest

What course are you interested in looking at? Options: BIO300, MATH100

Define it below, in quotes "", in the code below. This will be used in the rest of the code, and you can always come back and change it.

```{r cars}
course_of_interest <- "MATH100"
```

## Calculating SAI

SAI, or systemic advantage index, is a metric that takes into account multiple axes of student identities, including:

-   race/ethnicity

-   gender

-   socioeconomic status

-   parental education (i.e., first-generation college-going status)

💭 Can you think of any other systemic advantages not included in this index that likely influence student's outcomes in a course? What would be the challenges to adding those identities or advantages to this index?

➡️ **Your task: Walk through one of the lines of code and compare it with the SAI table below from the talk. Can you explain where the SAI assignment comes from?**

```{r SAI calculation, echo=TRUE}
#this code goes through all possible combinations of the 4 advantage axes and assigns an SAI based on that students' values
#as ethniccode_cat == 1 is the "BIPOC" label, all other categories are considered advantaged 
syndat <-
  syndat %>% mutate(sai = case_when(
    female == "0" & ethniccode_cat != "1" & firstgen == "0" & lowincomeflag == "0"  ~ "4",
    female == "1" & ethniccode_cat != "1" & firstgen == "0" & lowincomeflag == "0"  ~ "3",
    female == "0" & ethniccode_cat == "1" & firstgen == "0" & lowincomeflag == "0"  ~ "3", 
    female == "0" & ethniccode_cat != "1" & firstgen == "0" & lowincomeflag == "1"  ~ "3", 
    female == "0" & ethniccode_cat != "1" & firstgen == "1" & lowincomeflag == "0"  ~ "3", 
    female == "0" & ethniccode_cat == "1" & firstgen == "1" & lowincomeflag == "0"  ~ "2", 
    female == "0" & ethniccode_cat == "1" & firstgen == "0" & lowincomeflag == "1"  ~ "2", 
    female == "1" & ethniccode_cat == "1" & firstgen == "0" & lowincomeflag == "0"  ~ "2", 
    female == "0" & ethniccode_cat != "1" & firstgen == "1" & lowincomeflag == "1"  ~ "2", 
    female == "1" & ethniccode_cat != "1" & firstgen == "1" & lowincomeflag == "0"  ~ "2", 
    female == "1" & ethniccode_cat != "1" & firstgen == "0" & lowincomeflag == "1"  ~ "2", 
    female == "1" & ethniccode_cat != "1" & firstgen == "1" & lowincomeflag == "1"  ~ "1", 
    female == "1" & ethniccode_cat == "1" & firstgen == "1" & lowincomeflag == "0"  ~ "1",
    female == "1" & ethniccode_cat == "1" & firstgen == "0" & lowincomeflag == "1"  ~ "1", 
    female == "0" & ethniccode_cat == "1" & firstgen == "1" & lowincomeflag == "1"  ~ "1",
    female == "1" & ethniccode_cat == "1" & firstgen == "1" & lowincomeflag == "1"  ~ "0",
    TRUE ~ "NA"))
```

# Exploring course outcomes across SAI

Let's explore what grade outcomes look like across levels of SAI in our course of interest.

```{r SAI summary stats, warning=FALSE, message=FALSE}
syndat %>%
  filter(crs_name == course_of_interest) %>%
  group_by(crs_name, sai) %>%
  summarise(n = n(),
            mean_grade = mean(numgrade, na.rm = T),
            sd_grade = sd(numgrade, na.rm = T))
```

```{r SAI plot}
#plot raw grades by all disciplines 
ggplot(syndat, aes(x = sai, y = numgrade, color = crs_name)) + 
    stat_summary(geom = "point", fun.y = "mean", 
                 position = position_dodge(0.2)) + 
    stat_summary(geom = "errorbar", fun.data = "mean_cl_normal", 
                 width = 0.1, position = position_dodge(0.2)) + 
  theme_bw()
```

While we can see differences in raw grade outcomes across the advantages spectrum, many studies control for metrics of prior academic performance when evaluating outcomes in a course.

These are typically: high school GPA, standardized test scores (SAT/ACT), prior cumulative GPA at an institution, or GPA excluding the course of interest (GPAO).

💭 Given the talks today, what are some issues with referencing prior academic performance as a "control" for student preparation?

**Grade anomaly**, or the difference between the current course grade and a student's prior academic performance, can show us how outcomes in this course differ from student's previous experiences at the instution (or other academic settings).
